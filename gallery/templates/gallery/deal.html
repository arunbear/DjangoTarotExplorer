{% extends "gallery/main.html" %}

{% block local_scripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script>
        function shuffleCards(images) {
            images.sort(() => Math.random() - 0.5);
        }

        const images = {{ images_json|safe }};
        shuffleCards(images);
        const indexForCard = [0, 1];

        function refreshCards() {
            $('#image-1').prop('src', images[indexForCard[0]]);
            $('#caption-1').text(indexForCard[0] + 1);
            $('#image-2').prop('src', images[indexForCard[1]]);
            $('#caption-2').text(indexForCard[1] + 1);
        }

        function deal() {
            console.log(indexForCard);
            for (let i = 0; i < indexForCard.length; i++) {
                indexForCard[i] = (indexForCard[i] + 2) % images.length;
            }
            console.log(indexForCard);
        }

        $(document).ready(function() {
            $('#btn-deal').on('click', function () {
                refreshCards();
                deal();
            });
        });
    </script>
{% endblock %}

{% block local_style %}
    .card-holder {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-gap: 1px;
        align-items: stretch;
        justify-items: center;
    }

    .card-holder figure img {
        max-width: 100%;
    }

    .button-holder {
        text-align: center;
        margin-top: 1rem;
    }
{% endblock %}

{% block content %}
    <div class="card-holder">
        <figure>
            <img id="image-1" class="card" src="https://upload.wikimedia.org/wikipedia/commons/f/fc/Waite%E2%80%93Smith_Tarot_Roses_and_Lilies_cropped.jpg" alt="tarot-card">
            <figcaption id="caption-1" style="text-align: center"></figcaption>
        </figure>
        <figure>
            <img id="image-2" class="card" src="https://upload.wikimedia.org/wikipedia/commons/f/fc/Waite%E2%80%93Smith_Tarot_Roses_and_Lilies_cropped.jpg" alt="tarot-card">
            <figcaption id="caption-2" style="text-align: center"></figcaption>
        </figure>
    </div>
    <div class="button-holder">
        <button id="btn-shuffle" class="button" title="Shuffle the whole deck">Shuffle</button>
        <button id="btn-deal" class="button" title="Deal cards from the deck">Deal</button>
        <button id="btn-back" class="button" title="View previous cards">Back</button>
    </div>
{% endblock %}
